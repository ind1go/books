
<!DOCTYPE HTML>
<html lang="de" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Andere Plattformen · GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-youtubex/player.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-sectionx/sectionx.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-theme-api/theme-api.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="osem_bearbeiten.html" />
    
    
    <link rel="prev" href="osem_registrierung.html" />
    

    </head>
    <body>
        
  <script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  </script>
  
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Suchbegriff eingeben" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Einleitung
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="osem_registrierung.html">
            
                <a href="osem_registrierung.html">
            
                    
                    Registrierung
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="1.2.1" data-path="osem_custom_sensor.html">
            
                <a href="osem_custom_sensor.html">
            
                    
                    Andere Plattformen
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="osem_bearbeiten.html">
            
                <a href="osem_bearbeiten.html">
            
                    
                    Bearbeiten einer Station
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="osem_download.html">
            
                <a href="osem_download.html">
            
                    
                    Datendownload
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="osem_datenanalyse.html">
            
                <a href="osem_datenanalyse.html">
            
                    
                    Datenanalyse
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="osem_api.html">
            
                <a href="osem_api.html">
            
                    
                    REST API
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Veröffentlicht mit GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Andere Plattformen</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="manuelle-konfiguration-eines-sensors-auf-der-osem">Manuelle Konfiguration eines Sensors auf der OSeM</h1>
<p>In dieser Anleitung wird beispielhaft die Anbindung eines SHT15 Sensors in das OSeM Netzwerk beschrieben.
F&#xFC;r die Datenverarbeitung bzw. -&#xFC;bertragung nutzen wir einen Arduino Uno mit Arduino Ethernet Shield.
Die REST Schnittstelle bietet aber auch jeder anderen programmierbaren und mit dem Internet verbundenen Messstation die M&#xF6;glichkeit, Messungen auf der OSeM zu ver&#xF6;ffentlichen und zu teilen.</p>
<h2 id="materialien">Materialien</h2>
<ul>
<li>Arduino Uno R3</li>
<li>Arduino Ethernet Shield R3</li>
<li><a href="https://www.sparkfun.com/products/8257" target="_blank">Sparkfun SHT15 Breakout</a></li>
</ul>
<h2 id="aufbau">Aufbau</h2>
<center><img src="https://raw.githubusercontent.com/sensebox/resources/master/images/aufbau-sht15.png" width="300px"></center>

<ul>
<li>VCC zu 5V</li>
<li>DATA zu Pin 6</li>
<li>SCK zu Pin 7</li>
<li>GND zu Arduino GND</li>
</ul>
<h2 id="sht1x-bibliothek">SHT1x Bibliothek</h2>
<p>F&#xFC;r Sensoren der SHT1x Serie von Sensirion gibt es bereits eine einfache Arduino-Schnittstelle. <a href="https://github.com/practicalarduino/SHT1x" target="_blank">Lade die Bibliothek von Github herunter</a> und entpacke sie in deinen <code>Arduino/libraries</code> Ordner. Importiert die Bibliothek wie gehabt in deinen Arduino Sketch, und definiere zus&#xE4;tzlich den Daten- und Taktpin entsprechend der Verkabelung in obiger Abbildung. Danach kannst du eine Verbindung zum Sensor herstellen:</p>
<pre><code class="lang-arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;sht1x.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dataPin 6</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> clockPin 7</span>
SHT1x sht1x(dataPin, clockPin);
</code></pre>
<p>Nun lassen sich &#xFC;ber zwei Funktionen die Temperatur in Grad Celsius, sowie die relative Luftfeuchte in Prozent als Gleitkommazahl abspeichern:</p>
<pre><code class="lang-arduino"><span class="hljs-keyword">float</span> temp = sht1x.readTemperatureC();
<span class="hljs-keyword">float</span> humi = sht1x.readHumidity();
</code></pre>
<h2 id="manuelle-registrierung">Manuelle Registrierung</h2>
<p>Um einen Sensor mit der OSeM zu verbinden, musst du ihn <a href="https://opensensemap.org/register" target="_blank">zuerst dort registrieren</a>.
Falls du dabei keinen der senseBox-Baus&#xE4;tze nutzt, muss in Schritt 4 der Registrierung die manuelle Konfiguration gew&#xE4;hlt werden.
Wie unten in der Abbildung dargestellt, wird dort f&#xFC;r jedes gemessene Ph&#xE4;nomen ein neuer Sensor angelegt:</p>
<p><img src="https://raw.githubusercontent.com/senseBox/resources/master/images/osem_sensorconfig.png" alt="sensor konfiguration"></p>
<h2 id="opensensemap-api">openSenseMap API</h2>
<p>Eine REST Schnittstelle regelt den Zugang zur Datenbank auf dem OSeM Server.
Intern ist jede Messstation mit ihren Sensoren (bzw. Ph&#xE4;nomenen) verkn&#xFC;pft, die bei der Registrierung angegeben wurden.
In unserem Falle haben wir eine senseBox ID f&#xFC;r die Station, sowie jeweils eine Sensor ID f&#xFC;r Temperatur- und Luftfeuchtigkeitsmessungen bei der Registrierung generiert.
Die IDs werden dir nach der Registrierung per Mail zugeschickt.
Jede Messung wird dann &#xFC;ber das HTTP Protokoll mit der <code>POST</code> Operation an den Server gesendet.
Dazu muss eine eindeutige URI angegeben werden die wie folgt aufgebaut ist:</p>
<pre><code>https://api.opensensemap.org/senseBoxID/SensorID
</code></pre><blockquote>
<p><strong><em>Hinweis:</em></strong> <em>Sollte der verwendete Microcontroller nicht HTTPS-kompatibel sein, gibt es derzeit noch eine HTTP Schnittstelle: <code>http://opensensemap.org:8000/senseBoxID/sensorID</code></em></p>
</blockquote>
<p>Jede Messung wird einzeln im JSON Format &#xFC;ber das <code>value</code>-Attribut an den Server gesendet.
Angenommen, wir wollen von unserer Station (ID 1234) einen Messwert des Thermometers (ID abcd) von <code>22,5</code> an den OSeM Server schicken, dann s&#xE4;he der vollst&#xE4;ndige HTTP POST Request folgenderma&#xDF;en aus:</p>
<pre><code>POST /boxes/1234/abcd HTTP/1.1
Host:opensensemap.org
Content-Type: application/json
Connection: close
Content-Length: 14

{&#x201C;value&#x201C;:22.5}
</code></pre><blockquote>
<p><strong><em>Achtung:</em></strong> <em>Ab Zeile 7 werden die JSON-Daten gesendet. Der Zeilenumbruch (<code>\n</code>) in Zeile 6 ist notwendig um die Operation korrekt auszuf&#xFC;hren.</em></p>
</blockquote>
<h2 id="arduino-osem-client">Arduino OSeM Client</h2>
<p>Nach der Registrierung wird ein Arduino Sketch generiert, den du als Anhang in einer Best&#xE4;tigungsmail zugeschickt bekommst.
Diesen Sketch musst du noch anpassen, indem die SHT1x Bibliothek eingef&#xFC;gt, sowie die ben&#xF6;tigen Variablen und eine Sensorinstanz erstellt werden:</p>
<pre><code class="lang-arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;SPI.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Ethernet.h&gt;</span></span>

<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;sht1x.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> dataPin 6</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> clockPin 7</span>
SHT1x sht1x(dataPin, clockPin);

<span class="hljs-comment">//senseBox ID</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> senseBox_ID <span class="hljs-string">&quot;1234&quot;</span></span>
<span class="hljs-comment">//Sensor IDs</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> TEMPERATURESENSOR_ID <span class="hljs-string">&quot;abcd&quot;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> HUMIDITYSENSOR_ID <span class="hljs-string">&quot;efgh&quot;</span></span>
</code></pre>
<p>Innerhalb der if-Anweisung in der <code>loop</code>-Funktion, musst du nacheinander die Sensoren auslesen und mit der Hilfsfunktion <code>postFloatValue()</code> hochladen.</p>
<pre><code class="lang-arduino"><span class="hljs-keyword">void</span> <span class="hljs-built_in">loop</span>()
{
  <span class="hljs-comment">//Upload der Daten mit konstanter Frequenz</span>
  <span class="hljs-built_in">if</span> (<span class="hljs-built_in">millis</span>() - oldTime &gt;= postInterval)
  {
    oldTime = <span class="hljs-built_in">millis</span>();
    temperature = sht1x.readTemperatureC();
    postFloatValue(temperature, <span class="hljs-number">1</span>, temperatureSensorID);
    humidity = sht1x.readHumidity();
    postFloatValue(humidity, <span class="hljs-number">0</span>, humiditySensorID);
  }
}
</code></pre>
<p>Falls du ein Ethernet Modul nutzt, welches nicht mit der Ethernet Bibliothek kompatibel ist muss der Sketch entsprechend angepasst werden.
Solltest du weitere Fragen dazu haben, kannst du dich auch direkt <a href="#" onclick="openMail(&apos;support&apos;,&apos;sensebox.de&apos;)">an unseren Support wenden</a>.</p>
<p><div id="page-footer"><hr><p><span style="color: #666; font-size: 85%;">
  Made with &#x2665; vom senseBox Team am <a href="https://www.uni-muenster.de/Geoinformatics/" target="_blank">ifgi</a>, WWU M&#xFC;nster
</span>
<span style="color: #666; font-size: 85%; float: right; align: center;">
  Alle Inhalte ver&#xF6;ffentlicht unter <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
  <img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" align="center">
</span></p>
</div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            

        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Andere Plattformen","level":"1.2.1","depth":2,"next":{"title":"Bearbeiten einer Station","level":"1.3","depth":1,"path":"osem_bearbeiten.md","ref":"osem_bearbeiten.md","articles":[]},"previous":{"title":"Registrierung","level":"1.2","depth":1,"path":"osem_registrierung.md","ref":"osem_registrierung.md","articles":[{"title":"Andere Plattformen","level":"1.2.1","depth":2,"path":"osem_custom_sensor.md","ref":"osem_custom_sensor.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["theme-api","edit-link","localized-footer","scramble-mailto","hide-published-with","youtubex","katex","collapsible-chapters","sectionx","sitemap-general","piwik","scripts"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"piwik":{"URL":"piwik.uni-muenster.de/","siteId":25},"scripts":{"files":["../tawkto.js"]},"search":{},"collapsible-chapters":{},"localized-footer":{"filename":"FOOTER.md"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"sitemap-general":{"prefix":"https://books.sensebox.de/osem/"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"scramble-mailto":{"scrambleMethod":"jsFunction"},"sectionx":{"tag":"b"},"highlight":{},"youtubex":{"embedDescription":{"de":"Eingebettetes Video:","default":"Embedded video:"}},"theme-api":{"languages":[],"split":true,"theme":"light"},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":{"en":"Edit This Page","de":"Seite bearbeiten"},"base":"https://github.com/sensebox/books/tree/master/osem"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"de","gitbook":"*"},"file":{"path":"osem_custom_sensor.md","mtime":"2016-12-30T17:40:22.240Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-12-30T17:44:37.643Z"},"basePath":".","book":{"language":"de"}});
        });
    </script>
</div>


        
    
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-scramble-mailto/scramble-mailto.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-youtubex/player.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sectionx/sectionx.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-piwik/plugin.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-scripts/1483119879238-tawkto.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-theme-api/theme-api.js"></script>
        
    


    <script type="text/javascript">
        var _paq = _paq || [];
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function() {
            var u=(('https:' == document.location.protocol) ? 'https' : 'http') + '://piwik.uni-muenster.de/';
            // Ensure URL ends with slash
            if (u.slice(-1) !== '/') u+='/';
            _paq.push(['setTrackerUrl', u+'piwik.php']);
            _paq.push(['setSiteId', 25]);
            var d=document,
                g=d.createElement('script'),
                s=d.getElementsByTagName('script')[0];
            g.type='text/javascript';
            g.defer=true;
            g.async=true;
            g.src=u+'piwik.js';
            s.parentNode.insertBefore(g,s);
        })();
    </script>
    <noscript>
        <p><img src="http://piwik.uni-muenster.de/piwik.php?idsite=25"
                style="border:0;" alt="" /></p>
    </noscript>

    </body>
</html>

