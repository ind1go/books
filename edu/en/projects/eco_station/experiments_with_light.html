
<!DOCTYPE HTML>
<html lang="en" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Experiments with light Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.2">
        
        
        
    
    <link rel="stylesheet" href="../../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-youtubex/player.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-katex/katex.min.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.css">
                
            
                
                <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-sectionx/sectionx.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="../implement_sound.html" />
    
    
    <link rel="prev" href="./" />
    

    </head>
    <body>
        
  <script>
    var tag = document.createElement('script');
    tag.src = "https://www.youtube.com/iframe_api";
    var firstScriptTag = document.getElementsByTagName('script')[0];
    firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
  </script>
  
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../../">
            
                <a href="../../">
            
                    
                        <b>1.1.</b>
                    
                    Introduction
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../../getting_started/box_content.html">
            
                <a href="../../getting_started/box_content.html">
            
                    
                        <b>2.1.</b>
                    
                    Content of the box
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="../../getting_started/arduino_board.html">
            
                <a href="../../getting_started/arduino_board.html">
            
                    
                        <b>2.2.</b>
                    
                    Arduino / Genuino
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="../../getting_started/software_installation.html">
            
                <a href="../../getting_started/software_installation.html">
            
                    
                        <b>2.3.</b>
                    
                    Software Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="../../getting_started/arduino_ide.html">
            
                <a href="../../getting_started/arduino_ide.html">
            
                    
                        <b>2.4.</b>
                    
                    Arduino IDE
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Basics</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../../basics/digital_signals.html">
            
                <a href="../../basics/digital_signals.html">
            
                    
                        <b>3.1.</b>
                    
                    Digital Signals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="../../basics/analog_signals.html">
            
                <a href="../../basics/analog_signals.html">
            
                    
                        <b>3.2.</b>
                    
                    Analog Signals
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="../../basics/shields.html">
            
                <a href="../../basics/shields.html">
            
                    
                        <b>3.3.</b>
                    
                    Shields
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="../../basics/osem_upload.html">
            
                <a href="../../basics/osem_upload.html">
            
                    
                        <b>3.3.1.</b>
                    
                    openSenseMap Upload
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Projects</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../traffic_counter.html">
            
                <a href="../traffic_counter.html">
            
                    
                        <b>4.1.</b>
                    
                    Traffic Counter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="../traffic_light.html">
            
                <a href="../traffic_light.html">
            
                    
                        <b>4.2.</b>
                    
                    Traffic Light
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="./">
            
                <a href="./">
            
                    
                        <b>4.3.</b>
                    
                    DIY Eco Station
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter active" data-level="4.3.1" data-path="experiments_with_light.html">
            
                <a href="experiments_with_light.html">
            
                    
                        <b>4.3.1.</b>
                    
                    Experiments with light
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="../implement_sound.html">
            
                <a href="../implement_sound.html">
            
                    
                        <b>4.4.</b>
                    
                    Let's implement sound!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="../listening_for_sounds.html">
            
                <a href="../listening_for_sounds.html">
            
                    
                        <b>4.5.</b>
                    
                    Listening for sounds
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6" data-path="../../community_projects/">
            
                <a href="../../community_projects/">
            
                    
                        <b>4.6.</b>
                    
                    Community Projects
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.6.1" data-path="../../community_projects/Tutorial_ArduinoWeatherStation.html">
            
                <a href="../../community_projects/Tutorial_ArduinoWeatherStation.html">
            
                    
                        <b>4.6.1.</b>
                    
                    Mobile Sensor Logger
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.6.2" data-path="../../community_projects/Tutorial_HeatmapCampusDiepenbeek.html">
            
                <a href="../../community_projects/Tutorial_HeatmapCampusDiepenbeek.html">
            
                    
                        <b>4.6.2.</b>
                    
                    Heatmap
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Appendix</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="../../contributing.html">
            
                <a href="../../contributing.html">
            
                    
                        <b>5.1.</b>
                    
                    Contributing
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../../downloads.html">
            
                <a href="../../downloads.html">
            
                    
                        <b>5.2.</b>
                    
                    Downloads
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../.." >Experiments with light</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="diy---experiments-with-light">DIY - Experiments with light</h1>
<p>If we watch television, turn on the radio, write a message with our smartphone, or heat up food in the microwave, we are using electromagnetic energy. Today, all people are constantly dependent on this energy. Without it, life as we know it in modern cities would be completely different.</p>
<h2 id="aim-of-the-station">Aim of the station</h2>
<p>In this station we are using a light sensor to detect the illuminance of visible light in lux.</p>
<h2 id="materials">Materials</h2>
<ul>
<li>Light Sensor <code>TSL 45315</code></li>
</ul>
<h2 id="basics">Basics</h2>
<p>Electromagnetic energy moves in waves through space. These waves range from very long radio waves to very short wavelength gamma rays. The human eye can only perceive a very small part of this spectrum: visible light. Our sun is the source of energy over the entire spectrum. The Earth&apos;s atmosphere protects us from exposure to high levels of radiation that could be dangerous for us.</p>
<p>Here, the intensity of visible light is of main interest. To measure the illuminance of the incident light in the visible part of the spectrum, the unit lux is used. It indicates the ratio of the brightness in lumens per square meter. On a bright sunny day, the light is measured at about 100,000 lux, and for a full moon at night the illuminance is measured at only about 1 lux.</p>
<p>For this measurement you use the I2C sensor TSL45315 of AMS-TAOS. In the sensor datasheet you can see that its sensitivity is matched to the visible part of the light spectrum, which is approximately between 400 and 700 nm.</p>
<p>According to the data sheet, the sensitivity of this sensor reaches from 2 to 200000 Lux, with a resolution of 3 lux. Furthermore, the sensor needs a power supply of 3.3V.</p>
<h2 id="construction">Construction</h2>
<img src="https://raw.githubusercontent.com/sensebox/resources/master/images/edu/Aufbau_station_6.png" width="500">

<h2 id="basics">Basics</h2>
<p>We will use the library <code>Wire</code>. In the beginning we need a few constants that are defined  with the directive #. Unlike variables, they occupy a permanent place in the store. In our case, the bus address and the following register addresses of the sensor are to be saved.</p>
<img src="https://raw.githubusercontent.com/sensebox/resources/master/images/edu//Grundlagen_Station_6.png">

<p>These registers are used to configure and for communication:</p>
<pre><code class="lang-arduino"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span> <span class="hljs-meta-string">&lt;Wire.h&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> I2C_ADDR (0x29)</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REG_CONTROL 0x00</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REG_CONFIG 0x01</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REG_DATALOW 0x04</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REG_DATAHIGH 0x05</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> REG_ID 0x0A</span>
</code></pre>
<p>In the setup function you will connect the sensor and start the transmission.</p>
<pre><code class="lang-arduino"><span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">begin</span> ();
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">beginTransmission</span> (I2C_ADDR);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">write</span> (<span class="hljs-number">0x80</span> | REG_CONTROL);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">write</span> (<span class="hljs-number">0x03</span>); <span class="hljs-comment">// Power on</span>
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">endTransmission</span> ();
</code></pre>
<p>Next, we will set a fixed exposure time of 400 ms:</p>
<pre><code class="lang-arduino"><span class="hljs-built_in">Wire</span>.beginTransmisson (I2C_ADDR);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">write</span> (<span class="hljs-number">0x80</span> | REG_CONFIG);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">write</span> (<span class="hljs-number">0x00</span>); <span class="hljs-comment">// 400 ms</span>
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">endTransmission</span> ();
</code></pre>
<p>To change the shutter speed, you can change the corresponding value of <code>` 0x00</code> in 0x01<code>or</code>0x02` to reduce the exposure time to 200 or 100 ms in the configuration register of the sensor.
In the Loop function, we give the order to start the measurement routine and let the sensor send the data needed to calculate the illuminance:</p>
<pre><code class="lang-arduino"><span class="hljs-built_in">Wire</span>.beginTransmisson (I2C_ADDR);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">write</span> (<span class="hljs-number">0x80</span> | REG_DATALOW);
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">endTransmission</span> ();
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">requestFrom</span> (I2C_ADDR, <span class="hljs-number">2</span>); Request <span class="hljs-comment">// 2 bytes</span>
<span class="hljs-keyword">uint16_t</span> low = <span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">read</span> ();
<span class="hljs-keyword">uint16_t</span> high = <span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">read</span> ();
</code></pre>
<p>If the sensor still sends data, these should be caught afterwards, to avoid errors in the next passage.</p>
<pre><code class="lang-arduino"><span class="hljs-built_in">while</span> (<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">available</span> ()) {
<span class="hljs-built_in">Wire</span>.<span class="hljs-built_in">read</span> ();
}
</code></pre>
<p>Finally, you will use the data to calculate illuminance in lux. In the data sheet, there is the matching formula:</p>
<pre><code class="lang-arduino"><span class="hljs-keyword">uint32_t</span> lux;
lux = (high &lt;&lt; <span class="hljs-number">8</span>) | (Low &lt;&lt; <span class="hljs-number">0</span>);
lux *= <span class="hljs-number">1</span>; <span class="hljs-comment">// Multiplier for 400ms</span>
</code></pre>
<p>To adjust this formula to an exposure time of 200 or 100 ms, you can increase the multiplier to 2 or 4.</p>
<h2 id="exercise-1">Exercise 1</h2>
<p>Adapt this lesson&apos;s code to create a custom function that can print the sensor data to the Serial Monitor.</p>
<h2 id="exercise-2">Exercise 2</h2>
<p>Change the exposure time of the sensor and then compare the results of the measurements.</p>
<blockquote>
<p><strong><em>Tip:</em></strong> <em>Don&apos;t forget to adjust both the lux value and exposure time in the configuration register accordingly.</em></p>
</blockquote>
<p><div id="page-footer"><hr><p><span style="color: #666; font-size: 85%;">
    Made with &#x2665; by the senseBox team at <a href="https://www.uni-muenster.de/Geoinformatics/en/" target="_blank">ifgi</a>, WWU M&#xFC;nster
</span>
<span style="color: #666; font-size: 85%; float: right; align: center;">
    All content is published under <a href="https://creativecommons.org/licenses/by-sa/4.0/" target="_blank">CC BY-SA 4.0</a>
    <img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" align="center">
</span></p>
</div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="./" class="navigation navigation-prev " aria-label="Previous page: DIY Eco Station">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="../implement_sound.html" class="navigation navigation-next " aria-label="Next page: Let's implement sound!">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Experiments with light","level":"4.3.1","depth":2,"next":{"title":"Let's implement sound!","level":"4.4","depth":1,"path":"projects/implement_sound.md","ref":"projects/implement_sound.md","articles":[]},"previous":{"title":"DIY Eco Station","level":"4.3","depth":1,"path":"projects/eco_station/README.md","ref":"projects/eco_station/README.md","articles":[{"title":"Experiments with light","level":"4.3.1","depth":2,"path":"projects/eco_station/experiments_with_light.md","ref":"projects/eco_station/experiments_with_light.md","articles":[]}]},"dir":"ltr"},"config":{"plugins":["edit-link","localized-footer","scramble-mailto","hide-published-with","youtubex","katex","collapsible-chapters","sectionx@git+https://github.com/noerw/gitbook-plugin-sectionx.git#v3.2.0","sitemap-general","scripts"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"piwik":{"URL":"piwik.uni-muenster.de/","siteId":25},"scripts":{"files":["../tawkto.js"]},"search":{},"collapsible-chapters":{},"localized-footer":{"filename":"FOOTER.md"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"hide-published-with":{},"sitemap-general":{"prefix":"https://books.sensebox.de/edu/"},"katex":{},"fontsettings":{"theme":"white","family":"sans","size":2},"scramble-mailto":{"scrambleMethod":"jsFunction"},"sectionx":{"tag":"b"},"highlight":{},"youtubex":{"embedDescription":{"de":"Eingebettetes Video:","default":"Embedded video:"}},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"edit-link":{"label":{"en":"Edit This Page","de":"Seite bearbeiten"},"base":"https://github.com/sensebox/books/tree/master/edu"},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"language":"en","gitbook":"*"},"file":{"path":"projects/eco_station/experiments_with_light.md","mtime":"2016-12-30T17:40:22.236Z","type":"markdown"},"gitbook":{"version":"3.2.2","time":"2016-12-30T17:42:03.039Z"},"basePath":"../..","book":{"language":"en"}});
        });
    </script>
</div>


        
    <script src="../../../gitbook/gitbook.js"></script>
    <script src="../../../gitbook/theme.js"></script>
    
        
        <script src="../../../gitbook/gitbook-plugin-edit-link/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-scramble-mailto/scramble-mailto.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-hide-published-with/plugin.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-youtubex/player.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-collapsible-chapters/collapsible-chapters.js"></script>
        
    
        
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sectionx/sectionx.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-scripts/1483119724722-tawkto.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

